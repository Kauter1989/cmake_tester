# TestCPPdemo

Первым всегда идёт тест, который генерирует референсную картинку и студенческую. Последующие тесты производят сравнения заданных областей по методикам МНК и покомпонентного сравнения.

Запуск генерации картинок:
add_test(<Tag>_<Имя Теста> ${PROJECT_NAME} ../<Имя конфигурационного файла> ../<Имя исходной картинки> <Адрес референсной картинки> ${STUDADDR} <Адрес Результирующей Картинки**>)
        
Конфигурационный файл состоит их строк вида
<Имя фильтра> <top> <left> <up> <bottom>
        
Нетрудно догадаться, что соответствующие поля, указываемые при добавлении теста на фильтры (см. 14 строку) должны совпадать хотя бы с одним полем конфигурационного файла, либо же требуемая к проверке область должна лежать внутри заданной (если хочется сделать лояльный тест, например)

Добавление теста на фильтры:
add_test(<Tag>_<Имя Теста> ${PROJECT_NAME} <Имя Фильтра*> <Адрес референсной картинки> <Адрес Результирующей Картинки**> <Допустимое отклонение МНК> <Допустимое расхождение по числу пикселов> <top> <left> <up> <bottom>)
        
При добавлении такого теста не происходит повторных запусков утилит. Идёт лишь только загузка студенческой и референсной картинок и их сравнение по оговоренным выше методикам.

* Имя фильтра регистрируется подобным образом:
        filter::red r("Red");
где filter::red - класс фильтра, закрашивающего заданную область красным, Red - <ИмяФильтра>

* Может быть любым в той директории, где есть права минимум rw-

Пример:
# запуск референсной и тестируемой утилит
add_test(Trivial_Run ${PROJECT_NAME} ../config.txt ../ex.png ref.png ${STUDADDR} stud.png)
# сравнение полученных при применении красного фильтра результатов в нижней половине экрана
add_test(Trivial_Red1 ${PROJECT_NAME} Red ref.png stud.png 10 30 2 0 1 1)

Пример конфига:
Red 2 0 1 1
Threshold 0 0 2 2

**ВНИМАНИЕ**
Обратите внимание на числа *top left up bottom*. Они означают число, НА КОТОРОЕ надо поделить соответственно высоту, ширину, высоту, ширину экрана, чтобы получить координаты прямоугольника интереса в пикселах КРОМЕ нуля. Ноль означает нулевой пиксел.

**Как пользоваться утилитой в общем случае?**
tests/CMakeLists (содержащий список тестов), включается в utils/CMakeLists тестовой утилиты.
Соответственно все тесты имеют вид *add_test(<Тег>_<Имя теста> ${PROJECT_NAME} <аргументы утилиты>)*
В tests/CMakeLists соответственно парсится результат работы **тестовой утилиты**. То есть **формат вывода вы сами задаёте и сами же парсите результат его работы**. Так в тестере для программы фильтрации есть варианты вывода **\[OK | BAD *<сообщение об ошибке>*\] \[OK | BAD *<сообщение об ошибке>\]* **. Его и парсим.
